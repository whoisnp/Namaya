<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="/assets/css/styles.min.css" />
  </head>

  <body>
    <div class="container profile profile-view" id="profile">
      <hr />
      <nav class="navbar navbar-light navbar-expand-md">
        <div class="container-fluid">
          <div>
            <img src="/assets/img/Picture1.png" width="100" height="100" />
          </div>
          <h3 class="text-center">
            <strong
              ><span style="text-decoration: underline"
                >World Traditional And Creative Arts Federation&nbsp;</span
              >&amp;&nbsp;<span style="text-decoration: underline"
                >National Martial Arts &amp; Yoga Association</span
              ></strong
            >
          </h3>
          <div>
            <img src="/assets/img/Picture2.png" width="100" height="100" />
          </div>
        </div>
      </nav>
      <hr />
      <div>
        <img src="/assets/img/Picture3.png" width="100" height="100" />
        <h4 class="text-center">APPLICATION FORM</h4>
      </div>
      <form id="appfrm">
        <div class="form-row profile-row">
          <div class="col-md-8">
            <h1>Profile</h1>
            <hr />
            <div class="form-row">
              <div class="col-sm-12 col-md-6">
                <div class="form-group">
                  <label>Student Name :</label
                  ><input
                    class="form-control"
                    id="name"
                    type="text"
                    name="Name"
                  />
                </div>
                <div class="form-group">
                  <label>Date of Birth :</label
                  ><input class="form-control" id="dob" type="date" />
                </div>
              </div>
              <div class="col-sm-12 col-md-6">
                <div class="form-group">
                  <label>Father/Gaurdian Name :</label
                  ><input
                    class="form-control"
                    type="text"
                    name="FatherName"
                    id="FatherName"
                  />
                </div>
                <div class="form-group"><label>Gender :</label></div>
                <div class="form-check d-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    id="formCheck-2"
                    name="gender"
                    value="Male"
                  /><label class="form-check-label" for="formCheck-2"
                    >Male</label
                  >
                </div>
                <div class="form-check d-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    id="formCheck-1"
                    name="gender"
                    value="female"
                  /><label class="form-check-label" for="formCheck-1"
                    >Female</label
                  >
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Blood Group :</label
              ><input
                class="form-control"
                type="text"
                name="BldGrp"
                id="BldGrp"
                autocomplete="off"
              />
            </div>
            <div class="form-group">
              <label>Address :</label
              ><textarea id="address" class="form-control"></textarea>
            </div>
            <div class="form-group">
              <label>Mobile Number :</label
              ><input class="form-control" id="Mno" type="tel" />
            </div>
            <div class="form-group">
              <label>Email </label
              ><input
                class="form-control"
                type="email"
                id="email"
                autocomplete="off"
                required=""
                name="email"
              />
            </div>
            <hr />
            <div class="form-row">
              <div class="col-md-12 content-right">
                <button
                  id="sumbit"
                  class="btn btn-primary form-btn"
                  type="submit"
                >
                  Edit
                </button>
                <!-- <button class="btn btn-danger form-btn" type="reset">
                    CANCEL
                  </button> -->
              </div>
            </div>
          </div>
          <div class="col-md-4 relative">
            <div class="avatar">
              <div class="avatar-bg center"></div>
            </div>
            <input
              id="photo"
              class="form-control-file form-control"
              type="file"
              name="avatar-file"
              accept="image/png, image/jpeg"
            />
          </div>
        </div>
      </form>
    </div>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
      https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.8/firebase-database.js"></script>
    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyCmJCdJ5y8Px2gn7O6PTq_MxVx30Q4zZDM",
        authDomain: "projecttkr-4aa57.firebaseapp.com",
        projectId: "projecttkr-4aa57",
        storageBucket: "projecttkr-4aa57.appspot.com",
        messagingSenderId: "353303900963",
        appId: "1:353303900963:web:6ee6c1e0a0e774c2851296",
        measurementId: "G-12RFY7K0EN",
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      //   console.log(uid);
      function getData(uid) {
        firebase
          .database()
          .ref("Students/" + uid)
          .once("value")
          .then(function (snapshot) {
            var name = snapshot.val().name;
            var dob = snapshot.val().dob;
            var FatherName = snapshot.val().FatherName;
            var address = snapshot.val().address;
            var BldGrp = snapshot.val().BldGrp;
            var Mno = snapshot.val().Mno;
            var email = snapshot.val().email;

            document.getElementById("name").value = name;
            document.getElementById("address").value = address;
            document.getElementById("email").value = email;
          });
      }

      appfrm = document.querySelector("#appfrm");
      appfrm.addEventListener("submit", (e) => {
        e.preventDefault();
        var name = document.getElementById("name").value;
        var dob = document.getElementById("dob").value;
        var FatherName = document.getElementById("FatherName").value;
        var gender = radioGender();
        var address = document.getElementById("address").value;
        var BldGrp = document.getElementById("BldGrp").value;
        var Mno = document.getElementById("Mno").value;
        var email = document.getElementById("email").value;
        // saveMessage(name, dob, FatherName, gender ,address, BldGrp, Mno, email);
        change(name, dob, FatherName, gender, address, BldGrp, Mno, email);
        // console.log(name, dob, FatherName, gender, address, BldGrp, Mno, email);
        function radioGender() {
          var Gender = document.querySelector("input[name=gender]:checked")
            .value;
          return Gender;
        }
        function change(
          name,
          dob,
          FatherName,
          gender,
          address,
          BldGrp,
          Mno,
          email
        ) {
          var messagesRef = firebase.database().ref("Students/" + id);
          //   console.log(id);
          console.log(name);
          messagesRef.set({
            name: name,
            dob: dob,
            FatherName: FatherName,
            gender: gender,
            address: address,
            BldGrp: BldGrp,
            Mno: Mno,
            email: email,
          });
        }

        window.location.reload();
      });
      var query = location.search;
      //   console.log(query);
      var query = location.href.split("?")[1];
      var params = query.split("&");
      var id;
      params.forEach((param, index) => {
        var key = param.split("=")[0];
        var value = param.split("=")[1];
        if (key == "id") {
          id = value;
          getData(id);
        }
      });
      //   console.log(id);
    </script>
  </body>
</html>
